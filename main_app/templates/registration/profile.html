{%extends "base.html" %}
{%block content%}

{%if user.is_authenticated %}
<div class="container">
    <div class="row">
        <div class="col s12">
            <div class="card">
                <div class="card-content">
                    <div class=" row valign-wrapper">
                        <div class="col s2">
                            <form id="update-profile-pic" action="{%url 'add-photo' %}" method="POST" enctype="multipart/form-data">
                                     {% csrf_token %}   
                            <label for="input-image">
                                <img src="{{user.profile.url}}" id="output" class="responsive-img circle">  
                            </label>
                            <input id="input-image" class="display_none" type="file" name="input-image" accept="image/x-png,image/gif,image/jpeg"/>
                            </form>  
                            <script>
                                let inputImage = document.getElementById('input-image');
                                inputImage.onchange = function(e){
                                    if(e.target.files && e.target.files[0]){
                                        let output = document.getElementById('output');
                                        output.src = URL.createObjectURL(e.target.files[0]);
                                        document.getElementById("update-profile-pic").submit();
                                        output.onload = ()=>{
                                        URL.revokeObjectURL(output.src)
                                    }
                                    }
                                }
                            </script>
                        </div>
                        <div class="col s5 flow-text">
                            <h1>{{user.username}}</h1>
                        </div>
                        <div class="col s5 right-align">
                            Favorites: 0
                        </br>
                        Spots Posted: {{user.spot_set.count}}
                        </br>
                        Spots Commented: {{user.comment_set.count}}
                    
                        </div>
                        
                    </div>
                    {%for spot in user.spot_set.all%}
                    <div class="card col s12">
                        <div class="card-content">
                            <div class="card-title ">
                                <img class="responsive-img circle" style="height: 64px; width: 64px" src="{{spot.url}}">
                                {{spot.user.username}}
                                
                            </div>
                                {{spot.addr}}
                            
                        </div>
                    
                
                    </div>
                    {%endfor%}
                    {%for comment in user.comment_set.all%}
                    <div class="card col s12">
                        <div class="card-content">
                            <div class="card-title ">
                                <img class="responsive-img circle" style="height: 64px; width: 64px" src="{{comment.user.profile.url}}">
                                {{comment.user.username}}
                                
                            </div>
                                {{comment.notes}}
                                <div class="yellow">
                                    {%for i in rating_range%}
                                        {%if i < comment.rating%}
                                            *
                                        {%else%}
                                            -
                                        {%endif %}
                                    {%endfor %}
                                </div>
                            
                        </div>
                    
                
                    </div>
                    {%endfor%}
                </div>
            </div>
        </div>
    </div>
</div>
{%endif%}
{%endblock%}

